{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel ="stylesheet" href="{%static 'css/estilos.css' %}">
    <script src="{%static 'js/jquery-3.5.1.min.js' %}" type="text/javascript"></script>
    <title>Buscar checklists</title>
    <h1>Buscar checklist</h1>
</head>
<body>
    <form id="id-list-form" method="POST">
        {% csrf_token %}
        
        <label for="">Rut empresa </label><input type="search" name="id_cliente" id ="id_cliente" value="{{ID_CLIENTE}}" onkeyup="saveValue(this)" > 
        <input type="submit" id="boton" name="boton" value="Search">
        <br>
        {% if check %}
            <table id="tabla">
                {% for things in check %}
                {% if things.resultado %}
                <tr>
                    <td id = "id">{{things.id_cliente.id_cliente}}</td>
                    <td id = "empresa">{{things.id_cliente.nombre_empresa}}</td>
                    <td id = "item">{{things.checklist}}</td>
                    <td><a id="cancelar" class="cancelar" href="{% url 'cancelar' things.id %}" >NO</a></td>
                    <td><a href="">Editar</a></td>

                </tr>
                {% else %}
                <tr>
                    <td id = "id">{{things.id_cliente.id_cliente}}</td>
                    <td id = "empresa">{{things.id_cliente.nombre_empresa}}</td>
                    <td id = "item">{{things.checklist}}</td>
                    <td><a id = "tachar" class="tachar" href="{% url 'tachar' things.id %}" >SI</a></td>
                    <td><a href="">Editar</a></td>
                </tr>
                {% endif %}
                {% endfor %}
            </table>
        {% endif %}
    </form>


<script type="text/javascript">
    document.getElementById('id_cliente').value = getSavedValue('id_cliente');

    function saveValue(e){
        var id = e.id;
        var val = e.value;
        localStorage.setItem(id,val);
    }

    function getSavedValue(v){
        if(!localStorage.getItem(v)){
            return "";
        }
        return localStorage.getItem(v);
    }    

    window.onload = function(event){
        if(!window.location.hash){
            window.location = window.location + '#loaded';
            window.location.reload();
            document.getElementById('boton').click();
        }
    }


</script>
</body>
</html>